<!DOCTYPE html>
<html prefix="" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Fun and code">
<meta name="viewport" content="width=device-width">
<title>Pejibaye Blog (old posts, page 3) | Pejibaye Blog</title>
<link href="assets/css/all.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="http://kaeruct.github.io/index-3.html">
<link rel="prev" href="index.html" type="text/html">
<link rel="next" href="index-2.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="stories/about.html">About</a>
        <a class="sidebar-nav-item" href="archive.html">Archive</a>
        <a class="sidebar-nav-item" href="categories/index.html">Tags</a>
        <a class="sidebar-nav-item" href="rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="http://kaeruct.github.io/" title="Pejibaye Blog" rel="home">
        <img src="pejibaye.jpg" class="logo" alt=""><!--Pejibaye Blog--></a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        

<div class="posts">
    <article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/starry-sky-in-html5-canvas-pt1.html" class="u-url">Starry Sky in HTML5 Canvas - Part 1</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Andr√©s Villarreal</span></p>
            <p class="dateline"><a href="posts/starry-sky-in-html5-canvas-pt1.html" rel="bookmark"><time class="post-date published dt-published" datetime="2019-04-13T15:35:56-06:00" title="Apr 13, 2019 03:35 PM">Apr 13, 2019 03:35 PM</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>In my spare time I often enjoy creating visualizations using HTML5 canvas.
I'm planning to do a little presentation about this so I thought a good way to get started was to create a blog post explaining how to do a simple one.</p>
<p>This tutorial will teach you how to create something like the image below from scratch!</p>
<p><img alt="Animated Starry Sky with Moon" src="galleries/screenshots/starry/moon.gif"></p>
<blockquote>
<p><strong>IMPORTANT</strong> -- you can try out the result of <strong>this part</strong> of the tutorial by visiting this <a href="https://codesandbox.io/s/kmrx1z6wn7?fontsize=14">CodeSandbox</a>.
However, I encourage you to read the blog post and try to follow along to understand how and why it works.</p>
</blockquote>
<p>First, you will need an HTML file, let's name it <code>index.html</code>:</p>
<pre class="code literal-block"><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Starry sky<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
      <span class="nt">body</span><span class="o">,</span> <span class="nt">html</span> <span class="p">{</span>
        <span class="k">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nt">canvas</span> <span class="p">{</span>
        <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">canvas</span> <span class="na">id</span><span class="o">=</span><span class="s">"canvas"</span><span class="p">&gt;&lt;/</span><span class="nt">canvas</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre>


<p>Nothing crazy so far, just some styles and a <code>canvas</code> element.</p>
<p>Next, let's create a JavaScript file. Let's name this <code>index.js</code>.</p>
<pre class="code literal-block"><span></span><span class="kr">const</span> <span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s2">"#030318"</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">width</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">height</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">"#canvas"</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">"2d"</span><span class="p">);</span>
<span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
<span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="nx">backgroundColor</span><span class="p">;</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">render</span><span class="p">();</span>
</pre>


<p>In the code above, we set the canvas' width and height so it takes up the whole window.
Then, in the <code>render()</code> function, we fill the canvas with the background color.
If you run it on your browser, it will look like this:</p>
<p><img alt="Step 1" src="galleries/screenshots/starry/step1.png"></p>
<p>Yup. Not very interesting. Let's put something in there!
Let's add some code to our <code>index.js</code> file to draw some stars.</p>
<p>First, let's have a function that creates the stars.</p>
<pre class="code literal-block"><span></span><span class="kd">function</span> <span class="nx">createStars</span><span class="p">(</span><span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">,</span> <span class="nx">spacing</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">stars</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">width</span><span class="p">;</span> <span class="nx">x</span> <span class="o">+=</span> <span class="nx">spacing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="nx">height</span><span class="p">;</span> <span class="nx">y</span> <span class="o">+=</span> <span class="nx">spacing</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">star</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="nx">x</span><span class="p">,</span>
        <span class="nx">y</span><span class="o">:</span> <span class="nx">y</span>
      <span class="p">};</span>
      <span class="nx">stars</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">star</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">stars</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">stars</span> <span class="o">=</span> <span class="nx">createStars</span><span class="p">(</span><span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
</pre>


<p>The <code>spacing</code> parameter will control the spacing between stars.</p>
<p>Then, let's update our <code>render()</code> function so it renders the stars.</p>
<pre class="code literal-block"><span></span><span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="nx">backgroundColor</span><span class="p">;</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">);</span>
  <span class="nx">stars</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">star</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">star</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="kr">const</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">star</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="kr">const</span> <span class="nx">r</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s2">"rgb(255, 255, 255)"</span><span class="p">;</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">fill</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">}</span>
</pre>


<p>For our purposes, a star is a circle, so we can use the <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/arc"><code>arc()</code> function</a> to draw our stars.
An explanation of the parameters:</p>
<ul>
<li>
<code>x</code> and <code>y</code> are used for the position.</li>
<li>
<code>r</code> is used for the radius of the circle.</li>
<li>
<code>0</code> and <code>Math.PI * 2</code> are the start and end angle, respectively.
   A full circle goes from <code>0</code> to <code>2pi</code>.</li>
</ul>
<p>The line <code>ctx.fillStyle = "rgb(255, 255, 255)";</code> is used to set the color of the circle to white.</p>
<p>Let's see what we get now:</p>
<p><img alt="Step 2" src="galleries/screenshots/starry/step2.png"></p>
<p>It's definitely a bit more interesting. But it doesn't look like a starry sky at all!
Stars don't usually look so uniform and boring. We need to add some randomness.</p>
<p>Let's create a function called <code>randomInt(max)</code> that will return a random number:</p>
<pre class="code literal-block"><span></span><span class="kd">function</span> <span class="nx">randomInt</span><span class="p">(</span><span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">max</span><span class="p">);</span>
<span class="p">}</span>
</pre>


<p>Then, let's use these random numbers when creating our stars:</p>
<pre class="code literal-block"><span></span><span class="kd">function</span> <span class="nx">createStars</span><span class="p">(</span><span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">,</span> <span class="nx">spacing</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">stars</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">width</span><span class="p">;</span> <span class="nx">x</span> <span class="o">+=</span> <span class="nx">spacing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="nx">height</span><span class="p">;</span> <span class="nx">y</span> <span class="o">+=</span> <span class="nx">spacing</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">star</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">randomInt</span><span class="p">(</span><span class="nx">spacing</span><span class="p">),</span>
        <span class="nx">y</span><span class="o">:</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">randomInt</span><span class="p">(</span><span class="nx">spacing</span><span class="p">)</span>
      <span class="p">};</span>
      <span class="nx">stars</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">star</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">stars</span><span class="p">;</span>
<span class="p">}</span>
</pre>


<p><img alt="Step 3" src="galleries/screenshots/starry/step3.png"></p>
<p>That looks already almost real! Now let's make it so the stars are different sizes.
To do this, we will need a different radius for each star, so we will add it to the star objects.</p>
<pre class="code literal-block"><span></span><span class="kr">const</span> <span class="nx">maxStarRadius</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">createStars</span><span class="p">(</span><span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">,</span> <span class="nx">spacing</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">stars</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">width</span><span class="p">;</span> <span class="nx">x</span> <span class="o">+=</span> <span class="nx">spacing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="nx">height</span><span class="p">;</span> <span class="nx">y</span> <span class="o">+=</span> <span class="nx">spacing</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">star</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">randomInt</span><span class="p">(</span><span class="nx">spacing</span><span class="p">),</span>
        <span class="nx">y</span><span class="o">:</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">randomInt</span><span class="p">(</span><span class="nx">spacing</span><span class="p">),</span>
        <span class="nx">r</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">maxStarRadius</span><span class="p">,</span>
      <span class="p">};</span>
      <span class="nx">stars</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">star</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">stars</span><span class="p">;</span>
<span class="p">}</span>
</pre>


<p>Then, we will update the <code>render()</code> function so it uses the star's radius when drawing.
While we're at it, let's extract the circle drawing logic to a new function as well.</p>
<pre class="code literal-block"><span></span><span class="kd">function</span> <span class="nx">fillCircle</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">fillStyle</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="nx">fillStyle</span><span class="p">;</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fill</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="nx">backgroundColor</span><span class="p">;</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">);</span>
  <span class="nx">stars</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">star</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">star</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="kr">const</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">star</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="kr">const</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">star</span><span class="p">.</span><span class="nx">r</span><span class="p">;</span>
    <span class="nx">fillCircle</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="s2">"rgb(255, 255, 255)"</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>
</pre>


<p><img alt="Step 4" src="galleries/screenshots/starry/step4.png"></p>
<p>Much better! Now the stars are all different sizes!</p>
<p>This is all for part 1. You can continue reading <a href="posts/starry-sky-in-html5-canvas-pt2.html">Part 2</a>, where we will add a moon and make our stars flicker!</p>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/how-to-show-preview-images-when-sharing-links-of-your-website.html" class="u-url">How to show preview images when sharing links of your website</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Andr√©s Villarreal</span></p>
            <p class="dateline"><a href="posts/how-to-show-preview-images-when-sharing-links-of-your-website.html" rel="bookmark"><time class="post-date published dt-published" datetime="2019-04-13T01:08:24-06:00" title="Apr 13, 2019 01:08 AM">Apr 13, 2019 01:08 AM</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>You know when you share a link on social media or mesagging apps, sometimes the app shows a nice preview thumbnail with a description? You can click on it and it will take you to the linked website. I wanted to have this functionality for a website I was working on, so I did some research on how to get it working.</p>
<p>Short answer: use the <code>og:image</code> meta tag.</p>
<p>Longer answer: read on.</p>
<p>You have to use <a href="https://ogp.me/">Open Graph</a> meta tags.
There's a bunch of meta tags to use, but the ones you need for previews are the following:</p>
<pre class="code literal-block"><span></span>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">"twitter:card"</span> <span class="na">content</span><span class="o">=</span><span class="s">"summary"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">"og:title"</span> <span class="na">content</span><span class="o">=</span><span class="s">"Thumbnail example"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">"og:description"</span> <span class="na">content</span><span class="o">=</span><span class="s">"Only for Nic Cage fans"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">"og:image"</span> <span class="na">content</span><span class="o">=</span><span class="s">"https://www.placecage.com/c/460/300"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">"og:url"</span> <span class="na">content</span><span class="o">=</span><span class="s">"https://kaeruct.github.io/"</span><span class="p">&gt;</span>
</pre>


<p>When a website with the previous tags is shared on social media, you will get a nice preview card with thumbnail, title, and description.</p>
<p>Important points:</p>
<ul>
<li>You <strong>NEED</strong> to include the <code>twitter:card</code> meta tag for Twitter to display the preview. Otherwise it won't work. If you don't care about Twitter you can remove it.</li>
<li>Some apps/websites will not include your preview thumbnail if it's not served via HTTPS. So make sure the image URLs always start with <code>https://</code>!</li>
<li>The <code>og:url</code> value should point to the canonical URL of the page, not to the root of your website.</li>
</ul>
<p>Below you can see some examples:</p>
<h3>Twitter</h3>
<p><img alt="Twitter" src="galleries/screenshots/og/twitter.png"></p>
<h3>Slack</h3>
<p><img alt="Slack" src="galleries/screenshots/og/slack.png"></p>
<h3>Telegram</h3>
<p><img alt="Telegram" src="galleries/screenshots/og/telegram.png"></p>
<h3>WhatsApp</h3>
<p><img alt="WhatsApp" src="galleries/screenshots/og/whatsapp.png"></p>
<h3>Discord</h3>
<p><img alt="Discord" src="galleries/screenshots/og/discord.png"></p>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/migrating-old-style-javascript-code-to-es6.html" class="u-url">Migrating old-style JavaScript code to ES6</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Andr√©s Villarreal</span></p>
            <p class="dateline"><a href="posts/migrating-old-style-javascript-code-to-es6.html" rel="bookmark"><time class="post-date published dt-published" datetime="2017-12-28T15:26:16-06:00" title="Dec 28, 2017 03:26 PM">Dec 28, 2017 03:26 PM</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>Recently (at work) I had to migrate a medium-sized JavaScript codebase (20KLOC) to <a href="https://github.com/lukehoban/es6features">ES6</a>.</p>
<p>We wanted to migrate to take advantage of the new features such as arrow functions, destructuring, and classes (there are a bunch more!).
Additionally, I was tasked with introducing <a href="https://eslint.org/">eslint</a> and <a href="https://prettier.io/">prettier</a> to improve the quality of our code a bit more.</p>
<blockquote>
<p>Before diving into the migration process, first I'd like to give some context on the state of the application.</p>
<p>We already used <a href="https://www.npmjs.com/">npm</a> and <a href="https://webpack.js.org/">webpack</a> to build our frontend, so I thought the migration should be straightforward -- and it was.</p>
<p>I was heavily involved in modifying our build process to use npm instead of ad-hoc shell scripts, and I found <a href="https://www.keithcirkel.co.uk/how-to-use-npm-as-a-build-tool/">this guide</a> to be incredibly helpful.</p>
</blockquote>
<p>Back to the migration, the first thing I did was to add babel to webpack using <a href="https://github.com/babel/babel-loader">babel-loader</a>.
It was easy to add to webpack and took almost no time to set up.
This meant that webpack would take our JavaScript files and transpile them from ES6 to "normal" JavaScript that all browsers can run.
However, in order to get our mocha tests running, it was necessary to hook
babel into our tests as well. I used <a href="https://istanbul.js.org/docs/tutorials/es2015/">this guide</a> from istanbul and was able to get them running fairly quickly.</p>
<p>Once I ran the build and the tests and everything looked good, then it was time to really port our code to ES6.
First, it was necessary to port some code that was using the <a href="http://www.adequatelygood.com/JavaScript-Module-Pattern-In-Depth.html">module pattern</a> to ES6 module syntax. I did this manually (using search/replace tools) and it took me a few hours.</p>
<p>In some cases we had some ugly dependencies on globals so a bit of refactoring was required.
In cases where it wasn't possible, webpack has the <a href="https://webpack.js.org/plugins/provide-plugin/">ProvidePlugin</a>, which covers most cases.
I also found the <a href="https://github.com/webpack-contrib/expose-loader">expose-loader</a> to be useful becase we have some code not under our control that required jQuery to be a browser global.</p>
<p>Once that was done, it was time to get started with the syntax changes.
I found an amazing tool for that, <a href="https://lebab.io/">Lebab</a>. It is a very realiable tool and I would totally use it again.
I ran all the "safe" transformations, verified them, and then ran some of the "unsafe" ones, checking how the code changed each time.</p>
<p>Finally, I ran the build and our mocha tests to make sure they still passed.
The tests broke in a few places because of things like variables being shadowed because of the changes from <code>var</code> to <code>let</code> or <code>const</code>.</p>
<p>However, with the help of the <a href="https://eslint.org/docs/rules/no-shadow">no-shadow</a> eslint rule, I was able to find all those cases quickly and get them fixed. ESLint was also very helpful in making sure I was not breaking any code with the refactoring I had to do.</p>
<p>The lines of code initially went down because of the ES6 syntax sugar, but they went back up with the introduction of prettier and its opinionated formatting -- especially regarding line length.</p>
<p>In the end, the migration was not as terrible as I initially thought it would be, and now it's a bit more enjoyable to work on that codebase.</p>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/setting-up-sendmail-to-redirect-emails.html" class="u-url">Setting up sendmail to redirect emails</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Andr√©s Villarreal</span></p>
            <p class="dateline"><a href="posts/setting-up-sendmail-to-redirect-emails.html" rel="bookmark"><time class="post-date published dt-published" datetime="2016-05-14T10:33:44-06:00" title="May 14, 2016 10:33 AM">May 14, 2016 10:33 AM</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p><small>
  Disclaimer: the instructions below are for Ubuntu, but they should work for most distros,
  the biggest difference is that the configuration files might be located elsewhere.
</small></p>
<p>If you're like me, you have a main email address and other email addresses set up in other domains.</p>
<p>I dislike having to check all my email addresses individually, so I set up my mail servers to redirect
all the email to my main address automatically.</p>
<p>Sendmail has an aliases feature that makes this very simple to set up.</p>
<p>Let's say you want to redirect emails this way:</p>
<ul>
<li>
<code>webmaster@yourdomain.com</code> -&gt; <code>example@gmail.com, someoneelse@gmail.com</code>
</li>
<li>
<code>help@yourdomain.com</code> -&gt; <code>helper@gmail.com</code>
</li>
<li>
<code>support@yourdomain.com</code> -&gt; <code>helper@gmail.com</code>
</li>
</ul>
<p>Follow these steps as root:</p>
<ol>
<li>
<p>Change the <code>/etc/mail/aliases</code> file to look like this:</p>
<pre class="code literal-block"><span></span> webmaster: example@gmail.com, someoneelse@gmail.com
 help: helper@gmail.com
 support: help
</pre>


<p>As you can see, each line in the file matches an origin email to a destination email.
 Each line can reference previous entries as well.</p>
</li>
<li>
<p>After changing the file, run:</p>
<pre class="code literal-block"><span></span> $ newaliases
</pre>


</li>
<li>
<p>Make sure port 25 is open on your machine, so sendmail is able to listen for incoming email:</p>
<pre class="code literal-block"><span></span> $ iptables -A INPUT -p tcp --dport 25 -j ACCEPT
</pre>


<p>Also make sure to save the iptables rules so they will be restored when the service restarts.
 This varies by distro, so it's better to google something like <code>iptables save &lt;your distro&gt;</code>.</p>
</li>
<li>
<p>Change <code>/etc/mail/sendmail.mc</code> so sendmail receives email from the outside world.</p>
<p>Change this line:</p>
<pre class="code literal-block"><span></span> DAEMON_OPTIONS(`Family=inet,  Name=MTA-v4, Port=smtp, Addr=127.0.0.1')dnl
</pre>


<p>to</p>
<pre class="code literal-block"><span></span> DAEMON_OPTIONS(`Family=inet,  Name=MTA-v4, Port=smtp')dnl
</pre>


<p>We're not done modifying this file yet.
 Now we need to verify that the domain in the configuration matches your server's domain. If not, change it:</p>
<pre class="code literal-block"><span></span> MASQUERADE_AS(`yourdomain.com')dnl
</pre>


</li>
<li>
<p>After saving the file, you need to regenerate <code>sendmail.cf</code>:</p>
<pre class="code literal-block"><span></span> m4 /etc/mail/sendmail.mc &gt; /etc/mail/sendmail.cf
</pre>


</li>
<li>
<p>Add your domain to <code>/etc/mail/local-host-names</code>. This file has a domain per line.
    If your domain is not there, add it on a new line.</p>
</li>
<li>
<p>Restart sendmail:</p>
<pre class="code literal-block"><span></span> $ /etc/init.d/sendmail restart
</pre>


</li>
</ol>
<p>Depending on the configuration of your email client or web UI, the emails might end up stuck in a spam folder,
so make sure to check there.</p>
<p>If you use Gmail, you can make a filter to avoid sending your redirected emails to spam.
To do so:</p>
<ol>
<li>Do a search for <code>from:yourdomain.com</code>.</li>
<li>Click on "Create a filter with this search".</li>
<li>Check the "Never send it to Spam" box.</li>
<li>Click on "Create filter".</li>
</ol>
<p><img alt="Preventing email from being sent to Spam" src="galleries/screenshots/nospamfilter.png"></p>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2.html" rel="next">Older posts</a>
            </li>
        </ul></nav><footer id="footer"><p>Contents ¬© 2023 <a href="mailto:andres@villarreal.co.cr">Andr√©s Villarreal</a> - Powered by <a href="http://getnikola.com">Nikola</a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script type="text/javascript">
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//stats.villarreal.co.cr/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '3']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</body>
</html>
