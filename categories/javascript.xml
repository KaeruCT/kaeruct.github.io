<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Pejibaye Blog (Posts about javascript)</title><link>http://kaeruct.github.io/</link><description></description><atom:link href="http://kaeruct.github.io/categories/javascript.xml" type="application/rss+xml" rel="self"></atom:link><language>en</language><lastBuildDate>Sat, 13 Apr 2019 07:09:29 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Migrating old-style JavaScript code to ES6</title><link>http://kaeruct.github.io/posts/migrating-old-style-javascript-code-to-es6.html</link><dc:creator>Andres Villarreal</dc:creator><description>&lt;div&gt;&lt;p&gt;Recently (at work) I had to migrate a medium-sized JavaScript codebase (20KLOC) to &lt;a href="https://github.com/lukehoban/es6features"&gt;ES6&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We wanted to migrate to take advantage of the new features such as arrow functions, destructuring, and classes (there are a bunch more!).
Additionally, I was tasked with introducing &lt;a href="https://eslint.org/"&gt;eslint&lt;/a&gt; and &lt;a href="https://prettier.io/"&gt;prettier&lt;/a&gt; to improve the quality of our code a bit more.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Before diving into the migration process, first I'd like to give some context on the state of the application.&lt;/p&gt;
&lt;p&gt;We already used &lt;a href="https://www.npmjs.com/"&gt;npm&lt;/a&gt; and &lt;a href="https://webpack.js.org/"&gt;webpack&lt;/a&gt; to build our frontend, so I thought the migration should be straightforward -- and it was.&lt;/p&gt;
&lt;p&gt;I was heavily involved in modifying our build process to use npm instead of ad-hoc shell scripts, and I found &lt;a href="https://www.keithcirkel.co.uk/how-to-use-npm-as-a-build-tool/"&gt;this guide&lt;/a&gt; to be incredibly helpful.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Back to the migration, the first thing I did was to add babel to webpack using &lt;a href="https://github.com/babel/babel-loader"&gt;babel-loader&lt;/a&gt;.
It was easy to add to webpack and took almost no time to set up.
This meant that webpack would take our JavaScript files and transpile them from ES6 to "normal" JavaScript that all browsers can run.
However, in order to get our mocha tests running, it was necessary to hook
babel into our tests as well. I used &lt;a href="https://istanbul.js.org/docs/tutorials/es2015/"&gt;this guide&lt;/a&gt; from istanbul and was able to get them running fairly quickly.&lt;/p&gt;
&lt;p&gt;Once I ran the build and the tests and everything looked good, then it was time to really port our code to ES6.
First, it was necessary to port some code that was using the &lt;a href="http://www.adequatelygood.com/JavaScript-Module-Pattern-In-Depth.html"&gt;module pattern&lt;/a&gt; to ES6 module syntax. I did this manually (using search/replace tools) and it took me a few hours.&lt;/p&gt;
&lt;p&gt;In some cases we had some ugly dependencies on globals so a bit of refactoring was required.
In cases where it wasn't possible, webpack has the &lt;a href="https://webpack.js.org/plugins/provide-plugin/"&gt;ProvidePlugin&lt;/a&gt;, which covers most cases.
I also found the &lt;a href="https://github.com/webpack-contrib/expose-loader"&gt;expose-loader&lt;/a&gt; to be useful becase we have some code not under our control that required jQuery to be a browser global.&lt;/p&gt;
&lt;p&gt;Once that was done, it was time to get started with the syntax changes.
I found an amazing tool for that, &lt;a href="https://lebab.io/"&gt;Lebab&lt;/a&gt;. It is a very realiable tool and I would totally use it again.
I ran all the "safe" transformations, verified them, and then ran some of the "unsafe" ones, checking how the code changed each time.&lt;/p&gt;
&lt;p&gt;Finally, I ran the build and our mocha tests to make sure they still passed.
The tests broke in a few places because of things like variables being shadowed because of the changes from &lt;code&gt;var&lt;/code&gt; to &lt;code&gt;let&lt;/code&gt; or &lt;code&gt;const&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;However, with the help of the &lt;a href="https://eslint.org/docs/rules/no-shadow"&gt;no-shadow&lt;/a&gt; eslint rule, I was able to find all those cases quickly and get them fixed. ESLint was also very helpful in making sure I was not breaking any code with the refactoring I had to do.&lt;/p&gt;
&lt;p&gt;The lines of code initially went down because of the ES6 syntax sugar, but they went back up with the introduction of prettier and its opinionated formatting -- especially regarding line length.&lt;/p&gt;
&lt;p&gt;In the end, the migration was not as terrible as I initially thought it would be, and now it's a bit more enjoyable to work on that codebase.&lt;/p&gt;&lt;/div&gt;</description><category>es6</category><category>javascript</category><category>refactoring</category><category>webpack</category><guid>http://kaeruct.github.io/posts/migrating-old-style-javascript-code-to-es6.html</guid><pubDate>Thu, 28 Dec 2017 21:26:16 GMT</pubDate></item><item><title>How to use the Youtube JS API to play music in the background</title><link>http://kaeruct.github.io/posts/how-to-use-the-youtube-js-api-to-play-music-in-the-background.html</link><dc:creator>Andres Villarreal</dc:creator><description>&lt;div&gt;&lt;p&gt;The Youtube JavaScript API allows you to embed YouTube videos and
interact with them programatically. To use it, first you need to embed this
script into your page:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;script src="http://www.youtube.com/player_api"&amp;gt;&amp;lt;/script&amp;gt;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;If you just want the audio, you can hide the element that contains the video:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;div id="player" style="position: absolute; top: -9999px; left: -9999px;"&amp;gt;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Here we use absolute positioning with negative coordinates
because using &lt;code&gt;display: none;&lt;/code&gt; will prevent the &lt;code&gt;onReady&lt;/code&gt; handler
from the Youtube player from triggering on Firefox. I ran across this problem
when making &lt;a href="http://kaeru.neritic.net/projects/short-experiments/walk"&gt;this&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Finally, here's &lt;a href="http://kaeruct.github.io/examples/yt-js-api"&gt;a full example&lt;/a&gt; that will wait for the video to
load and automatically play it:&lt;/p&gt;
&lt;script src="https://gist.github.com/KaeruCT/dcfae82a15af514ea95e.js"&gt;&lt;/script&gt;&lt;/div&gt;</description><category>javascript</category><category>tutorials</category><category>youtube</category><guid>http://kaeruct.github.io/posts/how-to-use-the-youtube-js-api-to-play-music-in-the-background.html</guid><pubDate>Fri, 23 May 2014 18:29:55 GMT</pubDate></item><item><title>Rainbow Tunnel</title><link>http://kaeruct.github.io/posts/rainbow-tunnel.html</link><dc:creator>Andres Villarreal</dc:creator><description>&lt;div&gt;&lt;p&gt;Today I had some more time to code something fun, so I decided to make a tunnel
of sorts.&lt;/p&gt;
&lt;p&gt;The trick is really simple, first you just draw rings around the center of the page,
and tweak their position a bit depending on the position of the mouse.&lt;/p&gt;
&lt;p&gt;To achieve the rainbow effect, you just have to make it so each ring has its hue value
a little higher than the ring before it, and increase all of the rings' hues each frame.&lt;/p&gt;
&lt;p&gt;I did it a little different than that, I have a base hue, which I increase every frame,
and then when each ring gets drawn, it uses the base hue plus a small increment
(which you can control with the mouse wheel).&lt;/p&gt;
&lt;p&gt;I guess this is a bit trippy? &lt;a href="http://kaeruct.github.io/projects/tunnel"&gt;See it full-screen here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://kaeruct.github.io/projects/tunnel"&gt;&lt;iframe src="https://kaeruct.github.io/projects/tunnel/"&gt;&lt;/iframe&gt;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</description><category>fun</category><category>javascript</category><category>programming-projects</category><guid>http://kaeruct.github.io/posts/rainbow-tunnel.html</guid><pubDate>Thu, 07 Mar 2013 20:44:50 GMT</pubDate></item><item><title>Messing Around With Trig</title><link>http://kaeruct.github.io/posts/messing-around-with-trig.html</link><dc:creator>Andres Villarreal</dc:creator><description>&lt;div&gt;&lt;p&gt;Yesterday after work I had some time to waste, so I decided to do some
silly things in javascript with a canvas and some trigonometric magic.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://kaeruct.github.io/galleries/rainbow"&gt;Here are some screenshots of what they look like&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Move your mouse around to change some variables, and click to toggle clearing of
the canvas. You can achieve some trippy effects!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://kaeruct.github.io/projects/lel"&gt;colorful sine wave&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://kaeruct.github.io/projects/flower"&gt;colorful flower&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These are all on my github, in case you wanna &lt;a href="https://github.com/KaeruCT/short-experiments"&gt;take a look&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;</description><category>fun</category><category>javascript</category><category>programming-projects</category><guid>http://kaeruct.github.io/posts/messing-around-with-trig.html</guid><pubDate>Tue, 05 Mar 2013 19:49:47 GMT</pubDate></item></channel></rss>